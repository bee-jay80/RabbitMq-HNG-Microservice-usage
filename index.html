<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Generate FCM Token</title>

    <style>
        :root{
            --bg: #f4f7fb;
            --card: #ffffff;
            --muted: #6b7280;
            --accent: #2563eb;
            --accent-600: #1e40af;
            --radius: 10px;
            --max-width: 820px;
            font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial;
        }
        html, body {
            height: 100%;
            margin: 0;
            background: var(--bg);
            color: #0f172a;
        }
        .wrap {
            min-height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 36px 18px;
        }
        .card {
            background: var(--card);
            border-radius: var(--radius);
            box-shadow: 0 6px 20px rgba(2, 6, 23, 0.08);
            padding: 28px;
            max-width: var(--max-width);
            width: 100%;
        }
        h2 { margin: 0; font-size: 1.25rem; color: #0b1220; }
        p.lead { margin: 0; color: var(--muted); font-size: 0.95rem; }
        .controls {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
            margin: 16px 0;
        }
        button {
            background: var(--accent);
            color: #fff;
            border: 0;
            padding: 10px 14px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background .15s, transform .08s;
        }
        button:hover { background: var(--accent-600); transform: translateY(-1px); }
        textarea {
            width: 100%;
            min-height: 160px;
            resize: vertical;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #e6e9ef;
            background: #fafbfe;
            font-family: monospace;
            color: #0b1220;
        }
        .meta { margin-top: 12px; font-size: 0.88rem; color: var(--muted); }
    </style>
</head>

<body>

<div class="wrap">
    <div class="card">
        <h2>Generate Firebase FCM Token</h2>
        <p class="lead">Click the button to request a device token from Firebase Cloud Messaging.</p>

        <div class="controls">
            <button onclick="generateFCMToken()">Generate Token</button>
        </div>

        <label for="tokenBox"><strong>FCM Token</strong></label>
        <textarea id="tokenBox" placeholder="Your token will appear here..."></textarea>

        <p class="meta">Tokens identify a client for push messages. Keep them private.</p>
    </div>
</div>


<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-messaging-compat.js"></script>

<script>
    // 1️⃣ Your Firebase Config
    const firebaseConfig = {
        apiKey: "YOUR_KEY",
        authDomain: "YOUR_APP.firebaseapp.com",
        projectId: "YOUR_PROJECT",
        storageBucket: "YOUR_PROJECT.appspot.com",
        messagingSenderId: "YOUR_SENDER_ID",
        appId: "APP_ID"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    const messaging = firebase.messaging();

    // 2️⃣ Register service worker from GitHub Pages
    const swPath = "/RabbitMq-HNG-Microservice-usage/firebase-messaging-sw.js";

    async function generateFCMToken() {
        try {
            const registration = await navigator.serviceWorker.register(swPath);
            console.log("Service worker registered:", registration);

            const token = await messaging.getToken({
                vapidKey: "YOUR_VAPID_KEY",
                serviceWorkerRegistration: registration
            });

            if (token) {
                document.getElementById("tokenBox").value = token;
                console.log("FCM Token:", token);
            } else {
                alert("No token received. Permission may be blocked.");
            }

        } catch (error) {
            console.error("Error generating token:", error);
            alert("Failed to generate token. Check console.");
        }
    }
</script>

</body>
</html>
